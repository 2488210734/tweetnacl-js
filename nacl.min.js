!function(r){"use strict";function o(r,o){return r<<o|r>>>32-o}function n(r,o){var n=r[o+3];return n=n<<8|r[o+2],n=n<<8|r[o+1],n<<8|r[o+0]}function t(r,o,n){var t;for(t=0;4>t;t++)r[o+t]=255&n,n>>>=8}function e(r,e,f,c,u){var i,a,p,s=[],_=[],y=[],b=[];for(i=0;4>i;i++)_[5*i]=n(c,4*i),_[1+i]=n(f,4*i),_[6+i]=n(e,4*i),_[11+i]=n(f,16+4*i);for(i=0;16>i;i++)y[i]=_[i];for(i=0;20>i;i++){for(a=0;4>a;a++){for(p=0;4>p;p++)b[p]=_[(5*a+4*p)%16];for(b[1]^=o(b[0]+b[3]|0,7),b[2]^=o(b[1]+b[0]|0,9),b[3]^=o(b[2]+b[1]|0,13),b[0]^=o(b[3]+b[2]|0,18),p=0;4>p;p++)s[4*a+(a+p)%4]=b[p]}for(p=0;16>p;p++)_[p]=s[p]}if(u){for(i=0;16>i;i++)_[i]=_[i]+y[i]|0;for(i=0;4>i;i++)_[5*i]=_[5*i]-n(c,4*i)|0,_[6+i]=_[6+i]-n(e,4*i)|0;for(i=0;4>i;i++)t(r,4*i,_[5*i]),t(r,16+4*i,_[6+i])}else for(i=0;16>i;i++)t(r,4*i,_[i]+y[i]|0)}function f(r,o,n,t){e(r,o,n,t,!1)}function c(r,o,n,t){e(r,o,n,t,!0)}function u(r,o,n,t,e,c,u){var i,a,p=[],s=[];if(e){for(a=0;16>a;a++)p[a]=0;for(a=0;8>a;a++)p[a]=c[a];for(;e>=64;){for(f(s,p,u,A),a=0;64>a;a++)r[o+a]=(n?n[t+a]:0)^s[a];for(i=1,a=8;16>a;++a)i=i+p[a]|0,p[a]=i,i>>>=8;e-=64,o+=64,n&&(t+=64)}if(e>0)for(f(s,p,u,A),a=0;e>a;a++)r[o+a]=(n?n[t+a]:0)^s[a]}}function i(r,o,n,t,e){u(r,o,null,0,n,t,e)}function a(r,o,n,t,e){var f,u=[],a=[];for(c(u,t,e,A),f=0;8>f;f++)a[f]=t[16+f];i(r,o,n,a,u)}function p(r,o,n,t,e,f,i){var a,p=[],s=[];for(c(p,f,i,A),a=0;8>a;a++)s[a]=f[16+a];u(r,o,n,t,e,s,p)}function s(r,o,n,t,e,f){var c,u,i,a,p=function(r,o){var n,t=0;for(n=0;17>n;n++)t=t+(r[n]+o[n]|0)|0,r[n]=255&t,t>>>=8},s=[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,252],_=[],y=[],b=[],l=[],v=[];for(i=0;17>i;i++)y[i]=b[i]=0;for(i=0;16>i;i++)y[i]=f[i];for(y[3]&=15,y[4]&=252,y[7]&=15,y[8]&=252,y[11]&=15,y[12]&=252,y[15]&=15;e>0;){for(i=0;17>i;i++)l[i]=0;for(i=0;16>i&&e>i;++i)l[i]=n[t+i];for(l[i]=1,t+=i,e-=i,p(b,l),u=0;17>u;u++)for(_[u]=0,i=0;17>i;i++)_[u]+=b[i]*(u>=i?y[u-i]:320*y[u+17-i]|0)|0;for(u=0;17>u;u++)b[u]=_[u];for(a=0,i=0;16>i;i++)a=a+b[i]|0,b[i]=255&a,a>>>=8;for(a=a+b[16]|0,b[16]=3&a,a=5*(a>>>2)|0,i=0;16>i;i++)a=a+b[i]|0,b[i]=255&a,a>>>=8;a=a+b[16]|0,b[16]=a}for(i=0;17>i;i++)v[i]=b[i];for(p(b,s),c=0|-(b[16]>>>7),i=0;17>i;i++)b[i]^=c&(v[i]^b[i]);for(i=0;16>i;i++)l[i]=f[i+16];for(l[16]=0,p(b,l),i=0;16>i;i++)r[o+i]=b[i]}function _(r,o,n,t,e){var f,c=0;for(f=0;e>f;f++)c|=r[o+f]^n[t+f];return(1&c-1>>>8)-1}function y(r,o,n,t){return _(r,o,n,t,16)}function b(r,o,n,t){return _(r,o,n,t,32)}function l(r,o,n,t,e,f){var c=[];return s(c,0,n,t,e,f),y(r,o,c,0)}function v(r,o,n,t,e){var f;if(32>n)throw new Error("d < 32");for(p(r,0,o,0,n,t,e),s(r,16,r,32,n-32,r),f=0;16>f;f++)r[f]=0}function x(r,o,n,t,e){var f,c=[];if(32>n)throw new Error("d < 32");if(a(c,0,32,t,e),0!==l(o,16,o,32,n-32,c))return!1;for(p(r,0,o,0,n,t,e),f=0;32>f;f++)r[f]=0;return!0}function h(r,o){var n=[9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];N(r,o,n)}function E(r,o,n){var t=null;if("undefined"!=typeof window&&window.crypto)t=new Uint8Array(n),window.crypto.getRandomValues(t);else{if("undefined"==typeof require)throw new Error("no PRNG");var e=require("crypto");t=e?e.randomBytes(n):null}if(!t||t.length!==n)throw new Error("PRNG failed");for(var f=0;f<t.length;f++)r[o+f]=t[f]}function d(r,o){E(o,0,32),h(r,o)}function w(r,o,n){var t=[],e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];N(t,n,o),c(r,e,t,A)}function m(r,o,n,t,e,f){var c=[];w(c,e,f),k(r,o,n,t,c)}function B(r,o,n,t,e,f){var c=[];return w(c,e,f),z(r,o,n,t,c)}function g(r){var o,n=[];for(r=unescape(encodeURIComponent(r)),o=0;o<r.length;o++)n.push(r.charCodeAt(o));return n}function S(r){var o,n=[];for(o=0;o<r.length;o++)n.push(String.fromCharCode(r[o]));return decodeURIComponent(escape(n.join("")))}function Y(r){return"string"==typeof r?g(r):r}function C(r){var o,n=[],t=r.length;if("undefined"==typeof btoa)return new Buffer(r).toString("base64");for(o=0;t>o;o++)n.push(String.fromCharCode(r[o]));return btoa(n.join(""))}function T(r){var o,n=[];if("undefined"==typeof atob)return Array.prototype.slice.call(new Buffer(r,"base64"),0);for(r=atob(r),o=0;o<r.length;o++)n.push(r.charCodeAt(o));return n}function R(r,o){if(r.length!==U)throw new Error("bad key size");if(o.length!==Z)throw new Error("bad nonce size")}function O(r,o){if(r.length!==q)throw new Error("bad public key size");if(o.length!==G)throw new Error("bad secret key size")}var A=[101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107],N=function(){function r(r,o,n,t,e,f){var c,u=0;for(c=0;31>c;++c)u=u+(n[t+c]+e[f+c]|0)|0,r[o+c]=255&u,u>>>=8;u=u+(n[t+31]+e[f+31]|0)|0,r[o+31]=u}function o(r,o,n,t,e,f){var c,u=218;for(c=0;31>c;++c)u=u+((n[t+c]+65280|0)-e[f+c]|0)|0,r[o+c]=255&u,u>>>=8;u=u+(n[t+31]-e[f+31]|0)|0,r[o+31]=u}function n(r,o){var n,t=0;for(n=0;31>n;++n)t=t+r[o+n]|0,r[o+n]=255&t,t>>>=8;for(t=t+r[o+31]|0,r[o+31]=127&t,t=19*(t>>>7)|0,n=0;31>n;++n)t=t+r[o+n]|0,r[o+n]=255&t,t>>>=8;t=t+r[o+31]|0,r[o+31]=t}function t(o,n){var t,e,f=[];for(t=0;32>t;++t)f[t]=o[n+t];for(r(o,n,o,n,p,0),e=-(o[n+31]>>>7&1),t=0;32>t;++t)o[n+t]^=e&(f[t]^o[n+t])}function e(r,o,t,e,f,c){var u,i,a;for(u=0;32>u;++u){for(a=0,i=0;u>=i;++i)a=a+(t[e+i]*f[c+(u-i)]|0)|0;for(i=u+1;32>i;++i)a=a+(38*t[e+i]|0)*f[c+(u+32-i)]|0|0;r[o+u]=a}n(r,o)}function f(r,o,n,t){var e,f=0;for(e=0;31>e;++e)f=f+(121665*n[t+e]|0)|0,r[o+e]=255&f,f>>>=8;for(f=f+(121665*n[t+31]|0)|0,r[o+31]=127&f,f=19*(f>>>7)|0,e=0;31>e;++e)f=f+r[o+e]|0,r[o+e]=255&f,f>>>=8;f=f+r[o+e]|0,r[o+e]=f}function c(r,o,t,e){var f,c,u;for(f=0;32>f;++f){for(u=0,c=0;f-c>c;++c)u=u+(t[e+c]*t[e+(f-c)]|0)|0;for(c=f+1;f+32-c>c;++c)u=u+((38*t[e+c]|0)*t[e+(f+32-c)]|0)|0;u=2*u|0,0===(1&f)&&(u=u+(t[e+(f/2|0)]*t[e+(f/2|0)]|0)|0,u=u+((38*t[e+((f/2|0)+16)]|0)*t[e+((f/2|0)+16)]|0)|0),r[o+f]=u}n(r,o)}function u(r,o,n,t,e,f,c,u,i){var a,p,s;for(s=i-1>>>0,a=0;64>a;++a)p=s&(e[f+a]^c[u+a]),r[o+a]=c[u+a]^p,n[t+a]=e[f+a]^p}function i(n,t,i,a){var p,s,_,y=[],b=[],l=[],v=[],x=[],h=[],E=[],d=[],w=[],m=[],B=[],g=[],S=[],Y=[],C=[];for(p=0;32>p;++p)y[p]=n[t+p];for(y[32]=1,p=33;64>p;++p)y[p]=0;for(b[0]=1,p=1;64>p;++p)b[p]=0;for(_=254;_>=0;--_)s=i[a+(_/8|0)]>>>(7&_),s&=1,u(l,0,v,0,b,0,y,0,s),r(E,0,l,0,l,32),o(E,32,l,0,l,32),r(d,0,v,0,v,32),o(d,32,v,0,v,32),c(w,0,E,0),c(w,32,E,32),e(m,0,d,0,E,32),e(m,32,d,32,E,0),r(B,0,m,0,m,32),o(B,32,m,0,m,32),c(g,0,B,32),o(S,0,w,0,w,32),f(Y,0,S,0),r(C,0,Y,0,w,0),e(x,0,w,0,w,32),e(x,32,S,0,C,0),c(h,0,B,0),e(h,32,g,0,n,t),u(b,0,y,0,x,0,h,0,s);for(p=0;64>p;++p)n[t+p]=b[p]}function a(r,o,n,t){var f,u=[],i=[],a=[],p=[],s=[],_=[],y=[],b=[],l=[],v=[];for(c(u,0,n,t),c(v,0,u,0),c(l,0,v,0),e(i,0,l,0,n,t),e(a,0,i,0,u,0),c(l,0,a,0),e(p,0,l,0,i,0),c(l,0,p,0),c(v,0,l,0),c(l,0,v,0),c(v,0,l,0),c(l,0,v,0),e(s,0,l,0,p,0),c(l,0,s,0),c(v,0,l,0),f=2;10>f;f+=2)c(l,0,v,0),c(v,0,l,0);for(e(_,0,v,0,s,0),c(l,0,_,0),c(v,0,l,0),f=2;20>f;f+=2)c(l,0,v,0),c(v,0,l,0);for(e(l,0,v,0,_,0),c(v,0,l,0),c(l,0,v,0),f=2;10>f;f+=2)c(v,0,l,0),c(l,0,v,0);for(e(y,0,l,0,s,0),c(l,0,y,0),c(v,0,l,0),f=2;50>f;f+=2)c(l,0,v,0),c(v,0,l,0);for(e(b,0,v,0,y,0),c(v,0,b,0),c(l,0,v,0),f=2;100>f;f+=2)c(v,0,l,0),c(l,0,v,0);for(e(v,0,l,0,b,0),c(l,0,v,0),c(v,0,l,0),f=2;50>f;f+=2)c(l,0,v,0),c(v,0,l,0);e(l,0,v,0,y,0),c(v,0,l,0),c(l,0,v,0),c(v,0,l,0),c(l,0,v,0),c(v,0,l,0),e(r,o,v,0,a,0)}var p=[19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128];return function(r,o,n){var f,c=[],u=[];for(f=0;32>f;++f)u[f]=o[f];for(u[0]&=248,u[31]&=127,u[31]|=64,f=0;32>f;++f)c[f]=n[f];for(i(c,0,u,0),a(c,32,c,32),e(c,64,c,0,c,32),t(c,64),f=0;32>f;++f)r[f]=c[64+f]}}(),k=v,z=x,U=32,Z=24,I=32,K=16,P=32,j=32,q=32,G=32,L=32,X=Z,F=I,M=K;r.crypto_stream_xor=p,r.crypto_stream=a,r.crypto_stream_salsa20_xor=u,r.crypto_stream_salsa20=i,r.crypto_onetimeauth=s,r.crypto_onetimeauth_verify=l,r.crypto_verify_16=y,r.crypto_verify_32=b,r.crypto_secretbox=v,r.crypto_secretbox_open=x,r.crypto_scalarmult=N,r.crypto_scalarmult_base=h,r.crypto_box_beforenm=w,r.crypto_box_afternm=k,r.crypto_box=m,r.crypto_box_open=B,r.crypto_box_keypair=d,r.crypto_secretbox_KEYBYTES=U,r.crypto_secretbox_NONCEBYTES=Z,r.crypto_secretbox_ZEROBYTES=I,r.crypto_secretbox_BOXZEROBYTES=K,r.crypto_scalarmult_BYTES=P,r.crypto_scalarmult_SCALARBYTES=j,r.crypto_box_PUBLICKEYBYTES=q,r.crypto_box_SECRETKEYBYTES=G,r.crypto_box_BEFORENMBYTES=L,r.crypto_box_NONCEBYTES=X,r.crypto_box_ZEROBYTES=F,r.crypto_box_BOXZEROBYTES=M,r.crypto_randombytes=E,r.secretbox=r.secretbox||{},r.secretbox.seal=function(r,o,n){var t,e,f,c=[],u=[];for(t=0;I>t;t++)c.push(0);return c=c.concat(Y(r)),e=Y(n),f=Y(o),R(e,f),v(u,c,c.length,f,e),C(u.slice(K))},r.secretbox.open=function(r,o,n){var t,e,f,c=[],u=[];for(t=0;K>t;t++)u.push(0);try{u=u.concat(T(r))}catch(i){return!1}return u.length<32?!1:(e=Y(n),f=Y(o),R(e,f),x(c,u,u.length,f,e)?S(c.slice(I)):!1)},r.box=r.box||{},r.box.before=function(r,o){var n=Y(r),t=Y(o),e=[];return O(n,t),w(e,n,t),e},r.box.sealAfter=r.secretbox.seal,r.box.openAfter=r.secretbox.open,r.box.seal=function(o,n,t,e){var f=r.box.before(t,e);return r.secretbox.seal(o,n,f)},r.box.open=function(o,n,t,e){var f=r.box.before(t,e);return r.secretbox.open(o,n,f)}}("undefined"!=typeof exports?exports:window.nacl=window.nacl||{});