!function(r){"use strict";function o(r,o){return r<<o|r>>>32-o}function n(r,o){var n=r[o+3];return n=n<<8|r[o+2],n=n<<8|r[o+1],n<<8|r[o+0]}function t(r,o,n){var t;for(t=0;4>t;t++)r[o+t]=255&n,n>>>=8}function f(r,f,e,c,u){var a,i,s,p=[],_=[],v=[],l=[];for(a=0;4>a;a++)_[5*a]=n(c,4*a),_[1+a]=n(e,4*a),_[6+a]=n(f,4*a),_[11+a]=n(e,16+4*a);for(a=0;16>a;a++)v[a]=_[a];for(a=0;20>a;a++){for(i=0;4>i;i++){for(s=0;4>s;s++)l[s]=_[(5*i+4*s)%16];for(l[1]^=o(0|l[0]+l[3],7),l[2]^=o(0|l[1]+l[0],9),l[3]^=o(0|l[2]+l[1],13),l[0]^=o(0|l[3]+l[2],18),s=0;4>s;s++)p[4*i+(i+s)%4]=l[s]}for(s=0;16>s;s++)_[s]=p[s]}if(u){for(a=0;16>a;a++)_[a]=0|_[a]+v[a];for(a=0;4>a;a++)_[5*a]=0|_[5*a]-n(c,4*a),_[6+a]=0|_[6+a]-n(f,4*a);for(a=0;4>a;a++)t(r,4*a,_[5*a]),t(r,16+4*a,_[6+a])}else for(a=0;16>a;a++)t(r,4*a,0|_[a]+v[a])}function e(r,o,n,t){f(r,o,n,t,!1)}function c(r,o,n,t){f(r,o,n,t,!0)}function u(r,o,n,t,f,c,u){var a,i,s=[],p=[];if(f){for(i=0;16>i;i++)s[i]=0;for(i=0;8>i;i++)s[i]=c[i];for(;f>=64;){for(e(p,s,u,S),i=0;64>i;i++)r[o+i]=(n?n[t+i]:0)^p[i];for(a=1,i=8;16>i;++i)a=0|a+s[i],s[i]=a,a>>>=8;f-=64,o+=64,n&&(t+=64)}if(f>0)for(e(p,s,u,S),i=0;f>i;i++)r[o+i]=(n?n[t+i]:0)^p[i]}}function a(r,o,n,t,f){u(r,o,null,0,n,t,f)}function i(r,o,n,t,f){var e,u=[],i=[];for(c(u,t,f,S),e=0;8>e;e++)i[e]=t[16+e];a(r,o,n,i,u)}function s(r,o,n,t,f,e,a){var i,s=[],p=[];for(c(s,e,a,S),i=0;8>i;i++)p[i]=e[16+i];u(r,o,n,t,f,p,s)}function p(r,o,n,t,f,e){var c,u,a,i,s=function(r,o){var n,t=0;for(n=0;17>n;n++)t=0|t+(0|r[n]+o[n]),r[n]=255&t,t>>>=8},p=[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,252],_=[],v=[],l=[],y=[],h=[];for(a=0;17>a;a++)v[a]=l[a]=0;for(a=0;16>a;a++)v[a]=e[a];for(v[3]&=15,v[4]&=252,v[7]&=15,v[8]&=252,v[11]&=15,v[12]&=252,v[15]&=15;f>0;){for(a=0;17>a;a++)y[a]=0;for(a=0;16>a&&f>a;++a)y[a]=n[t+a];for(y[a]=1,t+=a,f-=a,s(l,y),u=0;17>u;u++)for(_[u]=0,a=0;17>a;a++)_[u]+=0|l[a]*(u>=a?v[u-a]:0|320*v[u+17-a]);for(u=0;17>u;u++)l[u]=_[u];for(i=0,a=0;16>a;a++)i=0|i+l[a],l[a]=255&i,i>>>=8;for(i=0|i+l[16],l[16]=3&i,i=0|5*(i>>>2),a=0;16>a;a++)i=0|i+l[a],l[a]=255&i,i>>>=8;i=0|i+l[16],l[16]=i}for(a=0;17>a;a++)h[a]=l[a];for(s(l,p),c=0|-(l[16]>>>7),a=0;17>a;a++)l[a]^=c&(h[a]^l[a]);for(a=0;16>a;a++)y[a]=e[a+16];for(y[16]=0,s(l,y),a=0;16>a;a++)r[o+a]=l[a]}function _(r,o,n,t,f){var e,c=0;for(e=0;f>e;e++)c|=r[o+e]^n[t+e];return(1&c-1>>>8)-1}function v(r,o,n,t){return _(r,o,n,t,16)}function l(r,o,n,t){return _(r,o,n,t,32)}function y(r,o,n,t,f,e){var c=[];return p(c,0,n,t,f,e),v(r,o,c,0)}function h(r,o,n,t,f){var e;if(32>n)throw new Error("crypto_secretbox: d < 32");for(s(r,0,o,0,n,t,f),p(r,16,r,32,n-32,r),e=0;16>e;e++)r[e]=0}function b(r,o,n,t,f){var e,c=[];if(32>n)throw new Error("crypto_secretbox_open: d < 32");if(i(c,0,32,t,f),0!=y(o,16,o,32,n-32,c))return!1;for(s(r,0,o,0,n,t,f),e=0;32>e;e++)r[e]=0;return!0}function d(r,o,n,t){var f=[9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];B(r,o,n,t,f,0)}function x(r){var o,n=[];for(r=unescape(encodeURIComponent(r)),o=0;o<r.length;o++)n.push(r.charCodeAt(o));return n}function g(r){var o,n=[];for(o=0;o<r.length;o++)n.push(String.fromCharCode(r[o]));return decodeURIComponent(escape(n.join("")))}function m(r){return"string"==typeof r?x(r):r}function w(r){var o,n=[],t=r.length;if("undefined"==typeof btoa)return new Buffer(r).toString("base64");for(o=0;t>o;o++)n.push(String.fromCharCode(r[o]));return btoa(n.join(""))}function E(r){var o,n=[];if("undefined"==typeof atob)return Array.prototype.slice.call(new Buffer(r,"base64"),0);for(r=atob(r),o=0;o<r.length;o++)n.push(r.charCodeAt(o));return n}function C(r,o){if(r.length!=Y)throw new Error("bad key length");if(o.length!=T)throw new Error("bad nonce length")}var S=[101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107],B=function(){function r(r,o,n,t,f,e){var c,u=0;for(c=0;31>c;++c)u=0|u+(0|n[t+c]+f[e+c]),r[o+c]=255&u,u>>>=8;u=0|u+(0|n[t+31]+f[e+31]),r[o+31]=u}function o(r,o,n,t,f,e){var c,u=218;for(c=0;31>c;++c)u=0|u+(0|(0|n[t+c]+65280)-f[e+c]),r[o+c]=255&u,u>>>=8;u=0|u+(0|n[t+31]-f[e+31]),r[o+31]=u}function n(r,o){var n,t=0;for(n=0;31>n;++n)t=0|t+r[o+n],r[o+n]=255&t,t>>>=8;for(t=0|t+r[o+31],r[o+31]=127&t,t=0|19*(t>>>7),n=0;31>n;++n)t=0|t+r[o+n],r[o+n]=255&t,t>>>=8;t=0|t+r[o+31],r[o+31]=t}function t(o,n){var t,f,e=[];for(t=0;32>t;++t)e[t]=o[n+t];for(r(o,n,o,n,s,0),f=-(1&o[n+31]>>>7),t=0;32>t;++t)o[n+t]^=f&(e[t]^o[n+t])}function f(r,o,t,f,e,c){var u,a,i;for(u=0;32>u;++u){for(i=0,a=0;u>=a;++a)i=0|i+(0|t[f+a]*e[c+(u-a)]);for(a=u+1;32>a;++a)i=0|(0|i+(0|38*t[f+a])*e[c+(u+32-a)]);r[o+u]=i}n(r,o)}function e(r,o,n,t){var f,e=0;for(f=0;31>f;++f)e=0|e+(0|121665*n[t+f]),r[o+f]=255&e,e>>>=8;for(e=0|e+(0|121665*n[t+31]),r[o+31]=127&e,e=0|19*(e>>>7),f=0;31>f;++f)e=0|e+r[o+f],r[o+f]=255&e,e>>>=8;e=0|e+r[o+f],r[o+f]=e}function c(r,o,t,f){var e,c,u;for(e=0;32>e;++e){for(u=0,c=0;e-c>c;++c)u=0|u+(0|t[f+c]*t[f+(e-c)]);for(c=e+1;e+32-c>c;++c)u=0|u+(0|(0|38*t[f+c])*t[f+(e+32-c)]);u=0|2*u,0===(1&e)&&(u=0|u+(0|t[f+(0|e/2)]*t[f+(0|e/2)]),u=0|u+(0|(0|38*t[f+((0|e/2)+16)])*t[f+((0|e/2)+16)])),r[o+e]=u}n(r,o)}function u(r,o,n,t,f,e,c,u,a){var i,s,p;for(p=a-1>>>0,i=0;64>i;++i)s=p&(f[e+i]^c[u+i]),r[o+i]=c[u+i]^s,n[t+i]=f[e+i]^s}function a(n,t,a,i){var s,p,_,v=[],l=[],y=[],h=[],b=[],d=[],x=[],g=[],m=[],w=[],E=[],C=[],S=[],B=[],Y=[];for(s=0;32>s;++s)v[s]=n[t+s];for(v[32]=1,s=33;64>s;++s)v[s]=0;for(l[0]=1,s=1;64>s;++s)l[s]=0;for(_=254;_>=0;--_)p=a[i+(0|_/8)]>>>(7&_),p&=1,u(y,0,h,0,l,0,v,0,p),r(x,0,y,0,y,32),o(x,32,y,0,y,32),r(g,0,h,0,h,32),o(g,32,h,0,h,32),c(m,0,x,0),c(m,32,x,32),f(w,0,g,0,x,32),f(w,32,g,32,x,0),r(E,0,w,0,w,32),o(E,32,w,0,w,32),c(C,0,E,32),o(S,0,m,0,m,32),e(B,0,S,0),r(Y,0,B,0,m,0),f(b,0,m,0,m,32),f(b,32,S,0,Y,0),c(d,0,E,0),f(d,32,C,0,n,t),u(l,0,v,0,b,0,d,0,p);for(s=0;64>s;++s)n[t+s]=l[s]}function i(r,o,n,t){var e,u=[],a=[],i=[],s=[],p=[],_=[],v=[],l=[],y=[],h=[];for(c(u,0,n,t),c(h,0,u,0),c(y,0,h,0),f(a,0,y,0,n,t),f(i,0,a,0,u,0),c(y,0,i,0),f(s,0,y,0,a,0),c(y,0,s,0),c(h,0,y,0),c(y,0,h,0),c(h,0,y,0),c(y,0,h,0),f(p,0,y,0,s,0),c(y,0,p,0),c(h,0,y,0),e=2;10>e;e+=2)c(y,0,h,0),c(h,0,y,0);for(f(_,0,h,0,p,0),c(y,0,_,0),c(h,0,y,0),e=2;20>e;e+=2)c(y,0,h,0),c(h,0,y,0);for(f(y,0,h,0,_,0),c(h,0,y,0),c(y,0,h,0),e=2;10>e;e+=2)c(h,0,y,0),c(y,0,h,0);for(f(v,0,y,0,p,0),c(y,0,v,0),c(h,0,y,0),e=2;50>e;e+=2)c(y,0,h,0),c(h,0,y,0);for(f(l,0,h,0,v,0),c(h,0,l,0),c(y,0,h,0),e=2;100>e;e+=2)c(h,0,y,0),c(y,0,h,0);for(f(h,0,y,0,l,0),c(y,0,h,0),c(h,0,y,0),e=2;50>e;e+=2)c(y,0,h,0),c(h,0,y,0);f(y,0,h,0,v,0),c(h,0,y,0),c(y,0,h,0),c(h,0,y,0),c(y,0,h,0),c(h,0,y,0),f(r,o,h,0,i,0)}var s=[19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128];return function(r,o,n,e,c,u){var s,p=[],_=[];for(s=0;32>s;++s)_[s]=n[e+s];for(_[0]&=248,_[31]&=127,_[31]|=64,s=0;32>s;++s)p[s]=c[u+s];for(a(p,0,_,0),i(p,32,p,32),f(p,64,p,0,p,32),t(p,64),s=0;32>s;++s)r[o+s]=p[64+s]}}(),Y=32,T=24,A=32,R=16,O=32,j=32;r.crypto_stream_xor=s,r.crypto_stream=i,r.crypto_stream_salsa20_xor=u,r.crypto_stream_salsa20=a,r.crypto_onetimeauth=p,r.crypto_onetimeauth_verify=y,r.crypto_verify_16=v,r.crypto_verify_32=l,r.crypto_secretbox=h,r.crypto_secretbox_open=b,r.crypto_scalarmult=B,r.crypto_scalarmult_base=d,r.crypto_secretbox_KEYBYTES=Y,r.crypto_secretbox_NONCEBYTES=T,r.crypto_secretbox_ZEROBYTES=A,r.crypto_secretbox_BOXZEROBYTES=R,r.crypto_scalarmult_BYTES=O,r.crypto_scalarmult_SCALARBYTES=j,r.secretbox=r.secretbox||{},r.secretbox.seal=function(r,o,n){var t,f,e,c=[],u=[];for(t=0;A>t;t++)c.push(0);return c=c.concat(m(r)),f=m(n),e=m(o),C(f,e),h(u,c,c.length,e,f),w(u.slice(R))},r.secretbox.open=function(r,o,n){var t,f,e,c=[],u=[];for(t=0;R>t;t++)u.push(0);try{u=u.concat(E(r))}catch(a){return!1}return u.length<32?!1:(f=m(n),e=m(o),C(f,e),b(c,u,u.length,e,f)?g(c.slice(A)):!1)}}("undefined"!=typeof exports?exports:window.nacl=window.nacl||{});