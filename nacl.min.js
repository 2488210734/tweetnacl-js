!function(r){"use strict";function o(r,o){return r<<o|r>>>32-o}function n(r,o){var n=r[o+3];return n=n<<8|r[o+2],n=n<<8|r[o+1],n<<8|r[o+0]}function t(r,o,n){var t;for(t=0;4>t;t++)r[o+t]=255&n,n>>>=8}function e(r,e,f,c,u){var a,i,p,_=[],s=[],y=[],b=[];for(a=0;4>a;a++)s[5*a]=n(c,4*a),s[1+a]=n(f,4*a),s[6+a]=n(e,4*a),s[11+a]=n(f,16+4*a);for(a=0;16>a;a++)y[a]=s[a];for(a=0;20>a;a++){for(i=0;4>i;i++){for(p=0;4>p;p++)b[p]=s[(5*i+4*p)%16];for(b[1]^=o(0|b[0]+b[3],7),b[2]^=o(0|b[1]+b[0],9),b[3]^=o(0|b[2]+b[1],13),b[0]^=o(0|b[3]+b[2],18),p=0;4>p;p++)_[4*i+(i+p)%4]=b[p]}for(p=0;16>p;p++)s[p]=_[p]}if(u){for(a=0;16>a;a++)s[a]=0|s[a]+y[a];for(a=0;4>a;a++)s[5*a]=0|s[5*a]-n(c,4*a),s[6+a]=0|s[6+a]-n(e,4*a);for(a=0;4>a;a++)t(r,4*a,s[5*a]),t(r,16+4*a,s[6+a])}else for(a=0;16>a;a++)t(r,4*a,0|s[a]+y[a])}function f(r,o,n,t){e(r,o,n,t,!1)}function c(r,o,n,t){e(r,o,n,t,!0)}function u(r,o,n,t,e,c,u){var a,i,p=[],_=[];if(e){for(i=0;16>i;i++)p[i]=0;for(i=0;8>i;i++)p[i]=c[i];for(;e>=64;){for(f(_,p,u,A),i=0;64>i;i++)r[o+i]=(n?n[t+i]:0)^_[i];for(a=1,i=8;16>i;++i)a=0|a+p[i],p[i]=a,a>>>=8;e-=64,o+=64,n&&(t+=64)}if(e>0)for(f(_,p,u,A),i=0;e>i;i++)r[o+i]=(n?n[t+i]:0)^_[i]}}function a(r,o,n,t,e){u(r,o,null,0,n,t,e)}function i(r,o,n,t,e){var f,u=[],i=[];for(c(u,t,e,A),f=0;8>f;f++)i[f]=t[16+f];a(r,o,n,i,u)}function p(r,o,n,t,e,f,a){var i,p=[],_=[];for(c(p,f,a,A),i=0;8>i;i++)_[i]=f[16+i];u(r,o,n,t,e,_,p)}function _(r,o,n,t,e,f){var c,u,a,i,p=function(r,o){var n,t=0;for(n=0;17>n;n++)t=0|t+(0|r[n]+o[n]),r[n]=255&t,t>>>=8},_=[5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,252],s=[],y=[],b=[],l=[],v=[];for(a=0;17>a;a++)y[a]=b[a]=0;for(a=0;16>a;a++)y[a]=f[a];for(y[3]&=15,y[4]&=252,y[7]&=15,y[8]&=252,y[11]&=15,y[12]&=252,y[15]&=15;e>0;){for(a=0;17>a;a++)l[a]=0;for(a=0;16>a&&e>a;++a)l[a]=n[t+a];for(l[a]=1,t+=a,e-=a,p(b,l),u=0;17>u;u++)for(s[u]=0,a=0;17>a;a++)s[u]+=0|b[a]*(u>=a?y[u-a]:0|320*y[u+17-a]);for(u=0;17>u;u++)b[u]=s[u];for(i=0,a=0;16>a;a++)i=0|i+b[a],b[a]=255&i,i>>>=8;for(i=0|i+b[16],b[16]=3&i,i=0|5*(i>>>2),a=0;16>a;a++)i=0|i+b[a],b[a]=255&i,i>>>=8;i=0|i+b[16],b[16]=i}for(a=0;17>a;a++)v[a]=b[a];for(p(b,_),c=0|-(b[16]>>>7),a=0;17>a;a++)b[a]^=c&(v[a]^b[a]);for(a=0;16>a;a++)l[a]=f[a+16];for(l[16]=0,p(b,l),a=0;16>a;a++)r[o+a]=b[a]}function s(r,o,n,t,e){var f,c=0;for(f=0;e>f;f++)c|=r[o+f]^n[t+f];return(1&c-1>>>8)-1}function y(r,o,n,t){return s(r,o,n,t,16)}function b(r,o,n,t){return s(r,o,n,t,32)}function l(r,o,n,t,e,f){var c=[];return _(c,0,n,t,e,f),y(r,o,c,0)}function v(r,o,n,t,e){var f;if(32>n)throw new Error("crypto_secretbox: d < 32");for(p(r,0,o,0,n,t,e),_(r,16,r,32,n-32,r),f=0;16>f;f++)r[f]=0}function h(r,o,n,t,e){var f,c=[];if(32>n)throw new Error("crypto_secretbox_open: d < 32");if(i(c,0,32,t,e),0!==l(o,16,o,32,n-32,c))return!1;for(p(r,0,o,0,n,t,e),f=0;32>f;f++)r[f]=0;return!0}function x(r,o,n,t){var e=[9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];N(r,o,n,t,e,0)}function d(r,o,n){var t=null;if("undefined"!=typeof window&&window.crypto)t=window.crypto.getRandomValues(new Uint8Array(n));else{if("undefined"==typeof require)throw new Error("no random number generator found");var e=require("crypto");t=e?e.randomBytes(n):null}if(!t||t.length!==n)throw new Error("failed to generate random bytes");for(var f=0;f<t.length;f++)r[o+f]=t[f]}function E(r,o){d(o,0,32),x(r,0,o,0)}function w(r,o,n){var t=[],e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];N(t,0,n,0,o,0),c(r,e,t,A)}function g(r,o,n,t,e,f){var c=[];w(c,e,f),k(r,o,n,t,c)}function m(r,o,n,t,e,f){var c=[];return w(c,e,f),U(r,o,n,t,c)}function B(r){var o,n=[];for(r=unescape(encodeURIComponent(r)),o=0;o<r.length;o++)n.push(r.charCodeAt(o));return n}function S(r){var o,n=[];for(o=0;o<r.length;o++)n.push(String.fromCharCode(r[o]));return decodeURIComponent(escape(n.join("")))}function Y(r){return"string"==typeof r?B(r):r}function C(r){var o,n=[],t=r.length;if("undefined"==typeof btoa)return new Buffer(r).toString("base64");for(o=0;t>o;o++)n.push(String.fromCharCode(r[o]));return btoa(n.join(""))}function T(r){var o,n=[];if("undefined"==typeof atob)return Array.prototype.slice.call(new Buffer(r,"base64"),0);for(r=atob(r),o=0;o<r.length;o++)n.push(r.charCodeAt(o));return n}function R(r,o){if(r.length!=Z)throw new Error("bad key length");if(o.length!=I)throw new Error("bad nonce length")}function O(r,o){if(r.length!=X)throw new Error("bad public key length");if(o.length!=F)throw new Error("bad secret key length")}var A=[101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107],N=function(){function r(r,o,n,t,e,f){var c,u=0;for(c=0;31>c;++c)u=0|u+(0|n[t+c]+e[f+c]),r[o+c]=255&u,u>>>=8;u=0|u+(0|n[t+31]+e[f+31]),r[o+31]=u}function o(r,o,n,t,e,f){var c,u=218;for(c=0;31>c;++c)u=0|u+(0|(0|n[t+c]+65280)-e[f+c]),r[o+c]=255&u,u>>>=8;u=0|u+(0|n[t+31]-e[f+31]),r[o+31]=u}function n(r,o){var n,t=0;for(n=0;31>n;++n)t=0|t+r[o+n],r[o+n]=255&t,t>>>=8;for(t=0|t+r[o+31],r[o+31]=127&t,t=0|19*(t>>>7),n=0;31>n;++n)t=0|t+r[o+n],r[o+n]=255&t,t>>>=8;t=0|t+r[o+31],r[o+31]=t}function t(o,n){var t,e,f=[];for(t=0;32>t;++t)f[t]=o[n+t];for(r(o,n,o,n,p,0),e=-(1&o[n+31]>>>7),t=0;32>t;++t)o[n+t]^=e&(f[t]^o[n+t])}function e(r,o,t,e,f,c){var u,a,i;for(u=0;32>u;++u){for(i=0,a=0;u>=a;++a)i=0|i+(0|t[e+a]*f[c+(u-a)]);for(a=u+1;32>a;++a)i=0|(0|i+(0|38*t[e+a])*f[c+(u+32-a)]);r[o+u]=i}n(r,o)}function f(r,o,n,t){var e,f=0;for(e=0;31>e;++e)f=0|f+(0|121665*n[t+e]),r[o+e]=255&f,f>>>=8;for(f=0|f+(0|121665*n[t+31]),r[o+31]=127&f,f=0|19*(f>>>7),e=0;31>e;++e)f=0|f+r[o+e],r[o+e]=255&f,f>>>=8;f=0|f+r[o+e],r[o+e]=f}function c(r,o,t,e){var f,c,u;for(f=0;32>f;++f){for(u=0,c=0;f-c>c;++c)u=0|u+(0|t[e+c]*t[e+(f-c)]);for(c=f+1;f+32-c>c;++c)u=0|u+(0|(0|38*t[e+c])*t[e+(f+32-c)]);u=0|2*u,0===(1&f)&&(u=0|u+(0|t[e+(0|f/2)]*t[e+(0|f/2)]),u=0|u+(0|(0|38*t[e+((0|f/2)+16)])*t[e+((0|f/2)+16)])),r[o+f]=u}n(r,o)}function u(r,o,n,t,e,f,c,u,a){var i,p,_;for(_=a-1>>>0,i=0;64>i;++i)p=_&(e[f+i]^c[u+i]),r[o+i]=c[u+i]^p,n[t+i]=e[f+i]^p}function a(n,t,a,i){var p,_,s,y=[],b=[],l=[],v=[],h=[],x=[],d=[],E=[],w=[],g=[],m=[],B=[],S=[],Y=[],C=[];for(p=0;32>p;++p)y[p]=n[t+p];for(y[32]=1,p=33;64>p;++p)y[p]=0;for(b[0]=1,p=1;64>p;++p)b[p]=0;for(s=254;s>=0;--s)_=a[i+(0|s/8)]>>>(7&s),_&=1,u(l,0,v,0,b,0,y,0,_),r(d,0,l,0,l,32),o(d,32,l,0,l,32),r(E,0,v,0,v,32),o(E,32,v,0,v,32),c(w,0,d,0),c(w,32,d,32),e(g,0,E,0,d,32),e(g,32,E,32,d,0),r(m,0,g,0,g,32),o(m,32,g,0,g,32),c(B,0,m,32),o(S,0,w,0,w,32),f(Y,0,S,0),r(C,0,Y,0,w,0),e(h,0,w,0,w,32),e(h,32,S,0,C,0),c(x,0,m,0),e(x,32,B,0,n,t),u(b,0,y,0,h,0,x,0,_);for(p=0;64>p;++p)n[t+p]=b[p]}function i(r,o,n,t){var f,u=[],a=[],i=[],p=[],_=[],s=[],y=[],b=[],l=[],v=[];for(c(u,0,n,t),c(v,0,u,0),c(l,0,v,0),e(a,0,l,0,n,t),e(i,0,a,0,u,0),c(l,0,i,0),e(p,0,l,0,a,0),c(l,0,p,0),c(v,0,l,0),c(l,0,v,0),c(v,0,l,0),c(l,0,v,0),e(_,0,l,0,p,0),c(l,0,_,0),c(v,0,l,0),f=2;10>f;f+=2)c(l,0,v,0),c(v,0,l,0);for(e(s,0,v,0,_,0),c(l,0,s,0),c(v,0,l,0),f=2;20>f;f+=2)c(l,0,v,0),c(v,0,l,0);for(e(l,0,v,0,s,0),c(v,0,l,0),c(l,0,v,0),f=2;10>f;f+=2)c(v,0,l,0),c(l,0,v,0);for(e(y,0,l,0,_,0),c(l,0,y,0),c(v,0,l,0),f=2;50>f;f+=2)c(l,0,v,0),c(v,0,l,0);for(e(b,0,v,0,y,0),c(v,0,b,0),c(l,0,v,0),f=2;100>f;f+=2)c(v,0,l,0),c(l,0,v,0);for(e(v,0,l,0,b,0),c(l,0,v,0),c(v,0,l,0),f=2;50>f;f+=2)c(l,0,v,0),c(v,0,l,0);e(l,0,v,0,y,0),c(v,0,l,0),c(l,0,v,0),c(v,0,l,0),c(l,0,v,0),c(v,0,l,0),e(r,o,v,0,i,0)}var p=[19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128];return function(r,o,n,f,c,u){var p,_=[],s=[];for(p=0;32>p;++p)s[p]=n[f+p];for(s[0]&=248,s[31]&=127,s[31]|=64,p=0;32>p;++p)_[p]=c[u+p];for(a(_,0,s,0),i(_,32,_,32),e(_,64,_,0,_,32),t(_,64),p=0;32>p;++p)r[o+p]=_[64+p]}}(),k=v,U=h,Z=32,I=24,K=32,j=16,q=32,L=32,X=32,F=32,M=32,P=I,V=K,z=j;r.crypto_stream_xor=p,r.crypto_stream=i,r.crypto_stream_salsa20_xor=u,r.crypto_stream_salsa20=a,r.crypto_onetimeauth=_,r.crypto_onetimeauth_verify=l,r.crypto_verify_16=y,r.crypto_verify_32=b,r.crypto_secretbox=v,r.crypto_secretbox_open=h,r.crypto_scalarmult=N,r.crypto_scalarmult_base=x,r.crypto_box_beforenm=w,r.crypto_box_afternm=k,r.crypto_box=g,r.crypto_box_open=m,r.crypto_box_keypair=E,r.crypto_secretbox_KEYBYTES=Z,r.crypto_secretbox_NONCEBYTES=I,r.crypto_secretbox_ZEROBYTES=K,r.crypto_secretbox_BOXZEROBYTES=j,r.crypto_scalarmult_BYTES=q,r.crypto_scalarmult_SCALARBYTES=L,r.crypto_box_PUBLICKEYBYTES=X,r.crypto_box_SECRETKEYBYTES=F,r.crypto_box_BEFORENMBYTES=M,r.crypto_box_NONCEBYTES=P,r.crypto_box_ZEROBYTES=V,r.crypto_box_BOXZEROBYTES=z,r.crypto_randombytes=d,r.secretbox=r.secretbox||{},r.secretbox.seal=function(r,o,n){var t,e,f,c=[],u=[];for(t=0;K>t;t++)c.push(0);return c=c.concat(Y(r)),e=Y(n),f=Y(o),R(e,f),v(u,c,c.length,f,e),C(u.slice(j))},r.secretbox.open=function(r,o,n){var t,e,f,c=[],u=[];for(t=0;j>t;t++)u.push(0);try{u=u.concat(T(r))}catch(a){return!1}return u.length<32?!1:(e=Y(n),f=Y(o),R(e,f),h(c,u,u.length,f,e)?S(c.slice(K)):!1)},r.box=r.box||{},r.box.before=function(r,o){var n=Y(r),t=Y(o),e=[];return O(n,t),w(e,n,t),e},r.box.seal=function(o,n,t,e){var f=r.box.before(t,e);return r.secretbox.seal(o,n,f)},r.box.open=function(o,n,t,e){var f=r.box.before(t,e);return r.secretbox.open(o,n,f)}}("undefined"!=typeof exports?exports:window.nacl=window.nacl||{});