<!doctype html>
<html>
<head>
  <title>Secretbox test</title>
  <meta charset="utf8">
</head>
<body>
  <script src="nacl.min.js"></script>
  <script>
    function submitForm(e) {
      var form = document.forms[0];
      var i, input, output, status = 'OK';
      var key = form.key.value;
      for (i = key.length; i < 32; i++) key += String.fromCharCode(0);
      var nonce = form.nonce.value;
      for (i = nonce.length; i < 24; i++) nonce += String.fromCharCode(0);
      input = form.text.value;
      var actval = form.act[0].checked ? form.act[0].value : (form.act[1].checked ? form.act[1].value : form.act[0].value);
      if (actval === 'seal') {
        output = nacl.secretbox.seal(input, nonce, key); 
      } else {
        output = nacl.secretbox.open(input, nonce, key);
        if (!output) {
          output = '';
          status = 'Failed to open';
        }
      } 
      form.text.value = output;
      document.getElementById('status').innerHTML = status;
      return false;
    }
  </script>
  <form onsubmit="return submitForm()">
    <p><label>
      Key: <input name="key" size="32" maxlength="32">
    </label></p>
    <p><label>
      Nonce: <input name="nonce" size="24" maxlength="24">
    </label></p>
    <p>Message:<br>
    <textarea name="text" rows=10 cols=32></textarea>
    </p>
    <p>
    <label><input type="radio" name="act" value="seal" checked> Seal</label>
    <label><input type="radio" name="act" value="open"> Open</label>
    </p>
    <input type="submit">
  </form>
  <div id="status"></div>
</body>
</html>
